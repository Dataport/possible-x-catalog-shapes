@prefix gx: <https://registry.lab.gaia-x.eu/development/api/trusted-shape-registry/v1/shapes/jsonld/trustframework#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix sh: <http://www.w3.org/ns/shacl#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix skos: <http://www.w3.org/2004/02/skos/core#> .
@prefix vcard: <http://www.w3.org/2006/vcard/ns#> .

# Tagus/Loire base
gx:ServiceOfferingShape
    a sh:NodeShape ;
    sh:targetClass gx:ServiceOffering ;
    sh:property
        [
            sh:path gx:providedBy ;
            sh:name "provided by"@en,
            "Service Bereitsteller"@de ;
            sh:description "a resolvable link to the participant self-description providing the service."@en,
            "Ein auflösbarer Link zum Teilnehmer, der dieses Angebot zur Verfügung stellt."@de ;
            sh:minCount 1 ;
            sh:maxCount 1 ;
            sh:nodeKind sh:IRI ;
            sh:order 0 ;
        ] ; # TODO add alternativePath to support all type of Participant
    sh:or ( [ sh:property gx:aggregationOfExists ] [ sh:property gx:aggregationOfNotExists ] ) ;
    sh:or ( [ sh:property gx:dependsOnExists ] [ sh:property gx:dependsOnNotExists ] ) ;
    sh:property
        [
            sh:path gx:termsAndConditions ;
            sh:name "terms & conditions"@en,
            "Serviceangebotspezifische Geschäftsbedingungen"@de ;
            sh:minCount 2 ; # set to 2 instead of 1 by MERLOT
            sh:description
                "a resolvable link to the service offering self-description related to the service and that can exist independently of it."@en,
                "Geschäftsbedingungen zu diesem Angebot."@de ;
            sh:node gx:SOTermsAndConditionsShape ;
            sh:order 6 ;
        ] ;
    sh:property
        [
            sh:path gx:policy ;
            sh:name "policy"@en,
            "Police"@de ;
            sh:minCount 1 ;
            sh:description
                "a list of policy expressed using a DSL (e.g., Rego or ODRL) (access control, throttling, usage, retention, …)."@en,
                "Eine Liste von Policen, ausgedrückt mithilfe einer DSL (z.B. Rego oder ODRL) (Zugriffskontrolle, Drosselung, Nutzung, Speicherung, …)."@de ;
            sh:datatype xsd:string ;
            sh:order 4;
        ] ;
    sh:property
        [
            sh:path gx:dataProtectionRegime ;
            sh:name "data protection regime"@en,
            "Datenschutzsregelung"@de ;
            sh:description "a list of data protection regime" ;
            sh:in ( "GDPR2016" "LGPD2019" "PDPA2012" "CCPA2018" "VCDPA2021" ) ;
            sh:message
                "Refer to https://gaia-x.gitlab.io/policy-rules-committee/trust-framework/service_and_subclasses/#service-offering Personal Data Protection Regimes"@en,
                "Siehe https://gaia-x.gitlab.io/policy-rules-committee/trust-framework/service_and_subclasses/#service-offering Personal Data Protection Regimes"@de ;
            sh:datatype xsd:string ;
            sh:order 3 ;
        ] ;
    sh:property
        [
            sh:path gx:dataAccountExport ;
            sh:name "data account export"@en,
            "Datenexportmethode"@de ;
            sh:minCount 1 ;
            sh:description "list of methods to export data from your user’s account out of the service"@en,
            "Eine Liste von Methoden um die Daten aus dem Dienst zu exportieren"@de ;
            sh:node gx:DataAccountExportShape ;
            sh:order 5 ;
        ] ;
    sh:property
        # Loire development
        #[   sh:description "One or more data protection regimes applying to the service offering." ;
        #    sh:in ( "GDPR2016" "LGPD2019" "PDPA2012" "CCPA2018" "VCDPA2021" ) ;
        #    sh:name "data protection regime" ;
        #    sh:order 5 ;
        #    sh:path gx:dataProtectionRegime 
        #],
        [   sh:datatype xsd:string ;
            sh:description "A human readable name of the entity."@en,
            "Name des Angebots."@de ;
            sh:minCount 1 ; # added by MERLOT
            sh:maxCount 1 ;
            sh:name "name"@en,
            "Servicename"@de ;
            sh:order 1 ;
            sh:path gx:name 
        ],
        #[   sh:datatype xsd:string ;
        #    sh:defaultValue "default:allow intent"^^xsd:string ;
        #    sh:description "Ome or more policies expressed using a DSL (e.g., Rego or ODRL) (access control, throttling, usage, retention, ...). If there is no specified usage policy constraints, the policy should express a simple default: " ;
        #    sh:minCount 1 ;
        #    sh:order 4 ;
        #    sh:path gx:servicePolicy 
        #],
        #[   sh:description "A list of resolvable links to Gaia-X Credentials of service offerings related to the service and that can exist independently of it." ;
        #    sh:name "depends on" ;
        #    sh:or ( [ sh:class gx:ServiceOffering ] [ sh:class gx:InfrastructureServiceOffering ] [ sh:class gx:ComputeServiceOffering ] [ sh:class gx:VirtualMachineServiceOffering ] ) ;
        #    sh:order 1 ;
        #    sh:path gx:dependsOn 
        #],
        #[   sh:class gx:Endpoint ;
        #    sh:description "Endpoint through which the Service Offering can be accessed." ;
        #    sh:maxCount 1 ;
        #    sh:name "endpoint" ;
        #    sh:nodeKind sh:BlankNodeOrIRI ;
        #    sh:order 9 ;
        #    sh:path gx:endpoint 
        #],
        #[   sh:description "Provision type of the service" ;
        #    sh:in ( "private" "public" "hybrid" ) ;
        #    sh:maxCount 1 ;
        #    sh:name "provision type" ;
        #    sh:order 8 ;
        #    sh:path gx:provisionType 
        #],
        #[   sh:description "A list of resolvable links to Gaia-X Credentials of resources related to the service and that can exist independently of it." ;
        #    sh:name "aggregation of" ;
        #    sh:or ( [ sh:class gx:PhysicalResource ] [ sh:class gx:VirtualResource ] [ sh:class gx:SoftwareResource ] [ sh:class gx:OperatingSystem ] ) ;
        #    sh:order 2 ;
        #    sh:path gx:aggregationOfResources 
        #],
        #[   sh:class gx:LegalPerson ;
        #    sh:description "A resolvable link to Gaia-X Credential of the participant providing the service." ;
        #    sh:maxCount 1 ;
        #    sh:minCount 1 ;
        #    sh:name "provided by" ;
        #    sh:nodeKind sh:IRI ;
        #    sh:order 0 ;
        #    sh:path gx:providedBy 
        #],
        #[   sh:class gx:TermsAndConditions ;
        #    sh:description "One or more Terms and Conditions applying to that service." ;
        #    sh:minCount 1 ;
        #    sh:name "terms and conditions" ;
        #    sh:nodeKind sh:BlankNodeOrIRI ;
        #    sh:order 3 ;
        #    sh:path gx:serviceOfferingTermsAndConditions 
        #],
        #[   sh:class gx:DataAccountExport ;
        #    sh:description "One or more methods to export data out of the service." ;
        #    sh:minCount 1 ;
        #    sh:name "data account export" ;
        #    sh:nodeKind sh:BlankNodeOrIRI ;
        #    sh:order 6 ;
        #    sh:path gx:dataAccountExport 
        #],
        [   sh:datatype xsd:string ;
            sh:description "A free text description of the entity."@en,
            "Eine Freitext-Beschreibung des Angebots."@de ;
            sh:maxCount 1 ;
            sh:name "description"@en,
            "Detaillierte Beschreibung des Services"@de ;
            sh:order 2 ;
            sh:path gx:description 
        ] .
        #[   sh:description "List of Resource references where service is hosted and can be instantiated. Can refer to availabilty zones, data centers, regions, etc." ;
        #    sh:name "hosted on" ;
        #    sh:or ( [ sh:class gx:VirtualResource ] [ sh:class gx:PhysicalResource ] ) ;
        #    sh:order 10 ;
        #    sh:path gx:hostedOn 
        #],
        #[   sh:datatype xsd:string ;
        #    sh:description "Keywords that describe / tag the service." ;
        #    sh:order 7 ;
        #    sh:path gx:keyword 
        #] .

gx:dependsOnExists
    sh:path gx:dependsOn ;
    sh:name "depends on"@en,
    "Abhängig von"@de ;
    sh:description
        "a resolvable link to the service offering self-description related to the service and that can exist independently of it."@en,
        "Ein auflösbarer Link zu einer Self-Description eines verwandten Angebots welches unabhängig hiervon existieren kann."@de ;
    sh:minCount 1 ;
    sh:nodeKind sh:IRI ;
    sh:qualifiedValueShape [sh:class gx:ServiceOffering] ;
    sh:qualifiedMinCount 1 ;
.

gx:dependsOnNotExists
    sh:path gx:dependsOn ;  
    sh:name "depends on"@en,
    "Abhängig von"@de ;
    sh:description
        "a resolvable link to the service offering self-description related to the service and that can exist independently of it."@en,
        "Ein auflösbarer Link zu einer Self-Description eines verwandten Angebots welches unabhängig hiervon existieren kann."@de ;
    sh:maxCount 0 ;
.

gx:aggregationOfExists
    sh:path gx:aggregationOf ;
    sh:name "aggregation of"@en,
    "Zusammenstellung von"@de ;
    sh:description
        "a resolvable link to the resources self-description related to the service and that can exist independently of it."@en,
        "Ein auflösbarer Link zu einer Self-Description eines verwandten Angebots welches unabhängig hiervon existieren kann."@de ;
    sh:minCount 1 ;
    sh:qualifiedValueShape [sh:or
        (
            [ sh:class gx:PhysicalResource ] 
            [ sh:class gx:VirtualResource ] 
            [ sh:class gx:DataResource ]
            [ sh:class gx:SoftwareResource]
        )] ;
    sh:qualifiedMinCount 1 ;
.

gx:aggregationOfNotExists
    sh:path gx:aggregationOf ;  
    sh:name "aggregation of"@en,
    "Zusammenstellung von"@de ;
    sh:description
        "a resolvable link to the resources self-description related to the service and that can exist independently of it."@en,
        "Ein auflösbarer Link zu einer Self-Description eines verwandten Angebots welches unabhängig hiervon existieren kann."@de ;
    sh:maxCount 0 ;
.

gx:SOTermsAndConditionsShape
    a sh:NodeShape ;
    sh:targetClass gx:SOTermsAndConditions ;
    sh:property
        [
            sh:path gx:URL ;
            sh:name "URL"@en,
            "Link zum Inhalt"@de ;
            sh:description "a resolvable link to document"@en,
            "Ein auflösbarer Link zum Inhalt"@de ;
            sh:minCount 1 ;
            sh:maxCount 1 ;
            sh:order 0 ;
            sh:datatype xsd:string ;
        ] ;
    sh:property
        [
            sh:path gx:hash ;
            sh:name "hash"@en,
            "Hash des Dokuments"@de ;
            sh:minCount 1 ;
            sh:maxCount 1 ;
            sh:order 1 ;
            sh:description "sha256 hash of the above document."@en,
            "SHA256 Hash des Dokumentes."@de ;
            sh:datatype xsd:string ;
        ] .

gx:DataAccountExportShape
    a sh:NodeShape ;
    sh:ignoredProperties ( rdf:type ) ; # added by merlot
    sh:targetClass gx:DataAccountExport ;
    sh:property
        [
            sh:path gx:requestType ;
            sh:datatype xsd:string ;
            sh:name "Request type"@en,
            "Anfragetyp"@de ;
            sh:minCount 1 ;
            sh:maxCount 1 ;
            sh:in ( "API" "email" "webform" "unregisteredLetter" "registeredLetter" "supportCenter" )
        ] ;
    sh:property
        [
            sh:path gx:accessType ;
            sh:datatype xsd:string ;
            sh:name "Access type"@en,
            "Zugriffstyp"@de ;
            sh:minCount 1 ;
            sh:maxCount 1 ;
            sh:description "type of data support: digital, physical."@en,
            "Typ des Zugriffs auf die Daten: digital, physisch"@de ;
            sh:in ( "digital" "physical" )
        ] ;
    sh:property
        [
            sh:path gx:formatType ;
            sh:datatype xsd:string ;
            sh:name "Format type"@en,
            "Datenformat"@de ;
            sh:minCount 1 ;
            sh:maxCount 1 ;
            sh:pattern "^\\w+/[-+.\\w]+$" ;
            sh:flags "i" ;
            skos:example "application/json" ;
            sh:description "type of Media Types (formerly known as MIME types) as defined by the IANA, see https://de.wikipedia.org/wiki/Internet_Media_Type ."@en,
            "Medientyp (früher bekannt als MIME Typ) wie von der IANA definiert, siehe https://de.wikipedia.org/wiki/Internet_Media_Type ."@de ;
        ] .