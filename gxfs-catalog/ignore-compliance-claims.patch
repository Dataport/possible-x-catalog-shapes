#  Copyright 2023-2024 Dataport AÃ¶R
#
#  Licensed under the Apache License, Version 2.0 (the "License");
#  you may not use this file except in compliance with the License.
#  You may obtain a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
#  Unless required by applicable law or agreed to in writing, software
#  distributed under the License is distributed on an "AS IS" BASIS,
#  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
#  See the License for the specific language governing permissions and
#  limitations under the License.

diff --git a/fc-service-core/src/main/java/eu/xfsc/fc/core/service/verification/claims/DanubeTechClaimExtractor.java b/fc-service-core/src/main/java/eu/xfsc/fc/core/service/verification/claims/DanubeTechClaimExtractor.java
index 033984ea..35bb2da1 100644
--- a/fc-service-core/src/main/java/eu/xfsc/fc/core/service/verification/claims/DanubeTechClaimExtractor.java
+++ b/fc-service-core/src/main/java/eu/xfsc/fc/core/service/verification/claims/DanubeTechClaimExtractor.java
@@ -54,6 +54,10 @@ public class DanubeTechClaimExtractor implements ClaimExtractor {
             
             for (Map<String, Object> csm: csms) {
                 cs = CredentialSubject.fromMap(csm);
+                if (cs.getType().equals("gx:compliance")) {
+                    log.info("Skipping claims from CS of type compliance");
+                    continue;
+                }
                 log.debug("extractClaims; CS claims: {}", cs.getClaims());
                 for (RdfNQuad nquad: cs.toDataset().toList()) {
                     log.debug("extractClaims; got NQuad: {}", nquad);
diff --git a/fc-service-core/src/main/java/eu/xfsc/fc/core/service/verification/claims/TitaniumClaimExtractor.java b/fc-service-core/src/main/java/eu/xfsc/fc/core/service/verification/claims/TitaniumClaimExtractor.java
index d65cb977..516b3484 100644
--- a/fc-service-core/src/main/java/eu/xfsc/fc/core/service/verification/claims/TitaniumClaimExtractor.java
+++ b/fc-service-core/src/main/java/eu/xfsc/fc/core/service/verification/claims/TitaniumClaimExtractor.java
@@ -52,7 +52,25 @@ public class TitaniumClaimExtractor implements ClaimExtractor {
     private void addClaims(List<SdClaim> claims, JsonObject vc) throws JsonLdError {
         JsonArray css = vc.getJsonArray("https://www.w3.org/2018/credentials#credentialSubject");
         for (JsonValue cs: css) {
-            Document csDoc = JsonDocument.of(cs.asJsonObject());
+            JsonObject csObj = cs.asJsonObject();
+            if (csObj.containsKey("@type")) {
+                boolean isComplianceCredential = false;
+                try {
+                    JsonArray typeArray = csObj.getJsonArray("@type");
+                    for (int i = 0; i < typeArray.size(); i++) {
+                        log.info("Found type value: {}", typeArray.getString(i));
+                        isComplianceCredential |= typeArray.getString(i)
+                                .equals("https://registry.lab.gaia-x.eu/development/api/trusted-shape-registry/v1/shapes/jsonld/trustframework#compliance");
+                    }
+                } catch (Exception e) {
+                        log.warn("Encountered error during VC type check: {}", e.getMessage());
+                }
+                if (isComplianceCredential) {
+                    log.info("Skipping claims from CS of type compliance");
+                    continue;
+                }
+            }
+            Document csDoc = JsonDocument.of(csObj);
             RdfDataset rdf = JsonLd.toRdf(csDoc).produceGeneralizedRdf(true).get();
             RdfGraph rdfGraph = rdf.getDefaultGraph();
             List<RdfTriple> triples = rdfGraph.toList();
